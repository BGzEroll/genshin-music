(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{9691:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/zen-keyboard",function(){return n(2703)}])},3544:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(828),r=n(5893),o=n(5055);function i(e){var t=e.checked,n=e.onChange,i=e.styleOuter,u=(0,a.Z)((0,o.F)(),1)[0];return(0,r.jsx)("button",{className:"switch-wrapper",onClick:function(){return n(!t)},style:i||{},"aria-label":t?"Switch to off":"Switch to on",children:(0,r.jsx)("div",{className:"switch-inner ".concat(t?"switch-inner-on":""),style:{backgroundColor:(t?u.get("accent"):u.layer("primary",.4)).toString()}})})}},6880:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(828),r=n(5893),o=n(6042),i=n(3564),u=n(7294),s=n(8949);function l(e){var t,n,l,c=e.children,d=e.page,h=(0,a.Z)((n=(t=(0,a.Z)((0,u.useState)(i.f6),2))[0],l=t[1],(0,u.useEffect)(function(){return(0,s.N7)(i.f6.state.other,function(){l((0,o.Z)({},i.f6))})},[]),[n,l]),1)[0];return(0,r.jsx)("div",{className:"app bg-image",style:{backgroundImage:"url(".concat(h.getOther("backgroundImage"+d),")")},children:c})}},781:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(5893);function r(e){var t=e.title,n=e.current,r=e.children,o=e.id;return(0,a.jsxs)("div",{className:n===o?"menu-panel menu-panel-visible":"menu-panel",children:[t&&(0,a.jsx)("div",{className:"menu-title",children:t}),(0,a.jsx)("div",{className:"panel-content-wrapper",children:r})]})}},4995:function(e,t,n){"use strict";n.d(t,{D:function(){return r}});var a=n(7294);function r(e){var t=e.text;return(0,a.useEffect)(function(){document.title=t},[t]),null}},1866:function(e,t,n){"use strict";n.d(t,{A:function(){return p}});var a=n(828),r=n(5893),o=n(7294),i=n(6042),u=n(9396),s=n(3544);function l(e){var t=e.data,n=e.volume,a=e.onVolumeChange,o=e.onVolumeComplete,s=e.onInstrumentPick,l=e.objectKey,c=e.instrument,d=e.theme,h=[],m=[],f=!0,v=!1,g=void 0;try{for(var p,y=t.options[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var x=p.value;x.startsWith("SFX")?m.push(x):h.push(x)}}catch(e){v=!0,g=e}finally{try{f||null==y.return||y.return()}finally{if(v)throw g}}return(0,r.jsxs)("div",{className:"instrument-picker",children:[(0,r.jsx)("select",{value:c,style:{textAlign:"left",paddingLeft:"0.4rem",backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(d.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},className:"select",onChange:function(e){s({key:l,data:(0,u.Z)((0,i.Z)({},t),{value:e.target.value})})},children:0===m.length?(0,r.jsx)(r.Fragment,{children:h.map(function(e){return(0,r.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("optgroup",{label:"Instruments",children:h.map(function(e){return(0,r.jsx)("option",{value:e,children:e.replace("-"," ")},e)})}),(0,r.jsx)("optgroup",{label:"SFX",children:m.map(function(e){return(0,r.jsx)("option",{value:e,children:e.replace("-"," ").replace("SFX_","")},e)})})]})}),(0,r.jsx)("input",{type:"range",min:1,max:100,value:n,onChange:function(e){a(Number(e.target.value))},onPointerUp:function(){o({key:l,value:n})}})]})}var c=n(9583);function d(e){var t=e.data,n=e.value,a=e.onChange,o=e.onComplete,s=e.objectKey,l=function(e){if("number"===t.type){var a=Number(n)+(t.increment||0)*e;!t.threshold||a<t.threshold[0]||a>t.threshold[1]||o({key:s,data:(0,u.Z)((0,i.Z)({},t),{value:a})})}};return(0,r.jsxs)("div",{className:"settings-input",children:["number"===t.type&&(0,r.jsx)("button",{onClick:function(){return l(-1)},className:"settings-input-button",style:{marginRight:"0.15rem"},"aria-label":"Decrement",children:(0,r.jsx)(c.iFH,{})}),(0,r.jsx)("input",{type:t.type,value:n,placeholder:t.placeholder||"",onBlur:function(){t.value!==n&&o({key:s,data:(0,u.Z)((0,i.Z)({},t),{value:n})})},onChange:function(e){var n=e.target;if("number"===t.type){var r=Number(n.value);if(n.value="",!t.threshold||r<t.threshold[0]||r>t.threshold[1])return;a(r)}else a(n.value)},"aria-label":t.name}),"number"===t.type&&(0,r.jsx)("button",{onClick:function(){return l(1)},className:"settings-input-button",style:{marginLeft:"0.15rem"},"aria-label":"Increment",children:(0,r.jsx)(c.wEH,{})})]})}function h(e){var t=e.data,n=e.value,a=e.onChange,o=e.objectKey;return(0,r.jsx)("input",{type:"range",min:t.threshold[0],max:t.threshold[1],value:n,onChange:function(e){a({key:o,data:(0,u.Z)((0,i.Z)({},t),{value:Number(e.target.value)})})}})}function m(e){var t=e.value,n=e.onChange,a=e.data,o=e.objectKey,s=e.children,l=e.theme,c=e.type;return(0,r.jsx)("select",{value:t,onChange:function(e){n({key:o,data:(0,u.Z)((0,i.Z)({},a),{value:"number"==typeof c?parseInt(e.target.value):e.target.value})})},style:{backgroundImage:"url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24' fill='".concat(l.getText("primary").hex().replace("#","%23"),"'><path d='M0 0h24v24H0z' fill='none'/><path d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'/></svg>\")")},children:s})}var f=n(5055),v=n(1014),g=(0,o.memo)(function(e){var t=e.data,n=e.update,c=e.objKey,g=e.changeVolume,p=(0,a.Z)((0,o.useState)(t.value),2),y=p[0],x=p[1],b=(0,a.Z)((0,o.useState)("instrument"===t.type?t.volume:0),2),k=b[0],j=b[1],Z=(0,a.Z)((0,f.F)(),1)[0],C=t.type;return(0,o.useEffect)(function(){x(t.value)},[t.value]),(0,r.jsxs)("div",{className:"settings-row",style:{backgroundColor:Z.layer("menu_background",.15).toString()},children:[(0,r.jsxs)("div",{className:(0,v.h)(t.tooltip),style:{flex:"1"},children:[t.name,t.tooltip&&(0,r.jsx)(v.u,{style:{width:"12rem"},children:t.tooltip})]}),"select"===C&&(0,r.jsx)(m,{theme:Z,type:t.options[0],onChange:n,value:t.value,objectKey:c,data:t,children:t.options.map(function(e){return(0,r.jsx)("option",{value:e,children:e},e)})}),("number"===C||"text"===C)&&(0,r.jsx)(d,{data:t,value:y,onChange:x,onComplete:n,objectKey:c}),"checkbox"===C&&(0,r.jsx)(s.Z,{checked:y,onChange:function(e){"checkbox"===C&&n({key:c,data:(0,u.Z)((0,i.Z)({},t),{value:e})})}}),"slider"===C&&(0,r.jsx)(h,{objectKey:c,data:t,value:y,onChange:n}),"instrument"===C&&g&&(0,r.jsx)(l,{theme:Z,volume:k,onInstrumentPick:n,onVolumeChange:j,onVolumeComplete:g,instrument:t.value,data:t,objectKey:c})]})},function(e,t){return e.data.value===t.data.value&&e.data.volume===t.data.volume&&e.update===t.update});function p(e){var t=e.settings,n=e.changeVolume,i=e.onUpdate,u=new Map;return Object.entries(t).forEach(function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];u.has(r.category)||u.set(r.category,{category:r.category,settings:{}}),u.get(r.category).settings[n]=r}),(0,r.jsx)(r.Fragment,{children:Array.from(u.values()).map(function(e){return(0,r.jsx)(o.Fragment,{children:(0,r.jsxs)("div",{className:"column",children:[(0,r.jsx)("h1",{className:"settings-group-title",children:e.category}),Object.entries(e.settings).map(function(e){var t=(0,a.Z)(e,2),o=t[0],u=t[1];return(0,r.jsx)(g,{objKey:o,data:u,changeVolume:n,update:i},o)})]})},e.category)})})}},9218:function(e,t,n){"use strict";var a=n(5893),r=n(7294);t.Z=(0,r.memo)(function(e){var t=e.children;return(0,a.jsx)(a.Fragment,{children:t})},function(e,t){var n,a,r,o;return(null===(n=t.children)||void 0===n?void 0:n.key)!==null||(null===(a=e.children)||void 0===a?void 0:a.key)!==null?(null===(r=e.children)||void 0===r?void 0:r.key)===(null===(o=t.children)||void 0===o?void 0:o.key):void 0!==e.children})},2703:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var a=n(7568),r=n(6042),o=n(9396),i=n(828),u=n(655),s=n(5893),l=n(3337),c=n(3707),d=n(1438),h=n(6305),m=n(2169),f=n(8949),v=function e(){var t=this;(0,d.Z)(this,e),this.keyboard=[],this.setKeyboardLayout=function(e){var n;(n=t.keyboard).splice.apply(n,[0,t.keyboard.length].concat((0,h.Z)(e)))},this.animateNote=function(e,n){t.keyboard[e].triggerAnimation(n)},this.resetKeyboardLayout=function(){t.keyboard.forEach(function(e){return e.setState({status:"",delay:"Genshin"===m.iC?100:200})})},this.resetOutgoingAnimation=function(){t.keyboard.forEach(function(e){return e.setState({animationId:0})})},this.setNoteState=function(e,n){t.keyboard[e].setState(n)},(0,f.rC)(this)};(0,u.__decorate)([f.LO],v.prototype,"keyboard",void 0);var g=new v,p=n(2114),y=n(7294),x=n(3564),b=n(8376),k=[{transform:"rotateY(0deg) scale(0.8)"},{transform:"rotateY(180deg) scale(0.8)"},{transform:"rotateY(360deg) scale(1)"}];function j(e){var t,n,a,r=e.note,o=e.onClick,u=e.noteImage,l=e.noteText,d=e.instrumentName,h=(0,i.Z)((0,y.useState)(""),2),f=h[0],v=h[1],g=(0,i.Z)((0,y.useState)(0),2),j=g[0],Z=g[1],C=(0,i.Z)((0,y.useState)(m.kx.text.light),2),N=C[0],w=C[1],S=(0,y.useRef)(null),_=(0,y.useCallback)(function(e){e.preventDefault(),o(r)},[o,r]);(0,y.useEffect)(function(){return(0,c.VZ)(r.data,function(){if("Genshin"===m.iC)v("clicked"),Z(function(e){return e+1}),setTimeout(function(){return v("")},100);else{var e=S.current;if(!e)return;e.animate(k,{duration:400})}})},[r,S]),(0,y.useEffect)(function(){return(0,c.VZ)(x.f6.state.data,function(){var e;w((e=x.f6.get("note_background"),"Genshin"!==m.iC?e.isDark()?m.kx.text.light:m.kx.text.dark:e.luminosity()>.65?m.kx.text.note:e.isDark()?m.kx.text.light:m.kx.text.dark))})},[]);var A=(t=m.Al.note,"clicked"===f&&(t+=" click-event"),t+("Genshin"===m.iC?"":" sky-zen-note")),E=null===(n=m.as[d])||void 0===n?void 0:n.clickColor;return(0,s.jsxs)("button",{onPointerDown:_,className:"button-hitbox-bigger",children:["Genshin"===m.iC&&(0,s.jsx)("div",{style:E&&x.f6.isDefault("accent")?{borderColor:E}:{},className:m.Al.noteAnimation},j),(0,s.jsxs)("div",{ref:S,className:A,children:["Genshin"===m.iC&&(0,s.jsx)(b.Z,{className:"genshin-border",fill:function(e){if("clicked"===e)return"transparent";if("toClickNext"===e||"toClickAndNext"===e)return"#63aea7";var t=x.f6.get("note_background").desaturate(.6);return t.isDark()?t.lighten(.45).hex():t.darken(.18).hex()}(f)}),u&&(0,s.jsx)(p.Z,{name:r.noteImage,color:x.f6.isDefault("accent")?null===(a=m.as[d])||void 0===a?void 0:a.fill:void 0,background:"clicked"===f?E&&x.f6.isDefault("accent")?E:"var(--accent)":"var(--note-background)"}),(0,s.jsx)("div",{className:m.Al.noteName,style:{color:N},children:l})]})]})}var Z=n(1328);function C(e){var t=e.onNoteClick,n=e.instrument,a=e.pitch,r=e.verticalOffset,o=e.scale,i=e.noteNameType,u=(0,c.ih)(g.keyboard);(0,y.useEffect)(function(){return Z.w.listen(function(e){var a=e.letter;if(!e.event.repeat){var r=n.getNoteFromCode(a);null!==r&&t(r)}},{id:"ZenKeyboard"}),function(){return Z.w.unregisterById("ZenKeyboard")}},[t,n]);var l="keyboard zen-keyboard";return 15===n.notes.length&&(l+=" keyboard-5"),14===n.notes.length&&(l+=" keyboard-5"),8===n.notes.length&&(l+=" keyboard-4"),6===n.notes.length&&(l+=" keyboard-3"),(0,s.jsx)("div",{className:l,style:{transform:"scale(".concat(o/100,") translateY(").concat(r,"px)")},children:u.map(function(e,r){return(0,s.jsx)(j,{instrumentName:n.name,noteText:n.getNoteText(r,i,a),noteImage:e.noteImage,note:e,onClick:t},r)})})}var N=n(7053),w=n(2809),S=n(9583),_=n(781),A=n(7671),E=n(1866),K=n(9218);function I(e){var t=e.settings,n=e.handleSettingChange,a=e.onVolumeChange,r=function(){h(!d)},o=(0,i.Z)((0,y.useState)("Settings"),2),u=o[0],l=o[1],c=(0,i.Z)((0,y.useState)(!0),2),d=c[0],h=c[1],m=(0,i.Z)((0,y.useState)(!1),2),f=m[0],v=m[1],g=(0,N.ZP)(function(){v(!1)},{ignoreFocusable:!0,active:""!==u});return(0,s.jsxs)("div",{className:"menu-wrapper",ref:g,children:[(0,s.jsx)("div",{className:"hamburger-top",onClick:function(){return v(!f)},children:(0,s.jsx)(K.Z,{children:(0,s.jsx)(S.Fm7,{})})}),(0,s.jsxs)("div",{className:"menu ".concat(f?"menu-visible":""),style:{justifyContent:"flex-end"},children:[(0,s.jsx)(A.s,{ariaLabel:"Close menu",style:{marginBottom:"auto"},onClick:function(){return v(!f)},children:(0,s.jsx)(S.aHS,{className:"icon"})}),(0,s.jsx)(A.s,{onClick:function(){l("Settings"),r()},isActive:"Settings"===u&&d,ariaLabel:"Open settings",children:(0,s.jsx)(S.p4t,{className:"icon"})}),(0,s.jsx)(A.s,{onClick:w.I.open,ariaLabel:"Open home menu",children:(0,s.jsx)(S.xng,{className:"icon"})})]}),(0,s.jsx)("div",{className:d&&f?"side-menu menu-open":"side-menu",children:(0,s.jsx)(_.Z,{title:"Settings",current:u,id:"Settings",children:(0,s.jsx)(E.A,{settings:t,onUpdate:n,changeVolume:a})})})]})}var F=n(1841),V=n(5839),L=n(657),P=n(7557),T=n(5684),O=n(4339),D=n(9731),z=n(4995),B=n(6880);function M(){var e,t=(0,i.Z)((0,y.useState)(F.$h.data),2),n=t[0],c=t[1],d=(0,i.Z)((0,y.useState)(new V.ZP),2),h=d[0],m=d[1],f=(0,i.Z)((0,y.useState)(!1),2),v=f[0],p=f[1];(0,y.useEffect)(function(){var e=T.j.getZenKeyboardSettings();return L.A.bpm=e.metronomeBpm.value,m(new V.ZP(e.instrument.value)),c(e),P.n.setReverb(e.caveMode.value),function(){return O.kg.hidePill()}},[]);var x=(0,y.useCallback)(function(e){T.j.updateZenKeyboardSettings(e)},[]);(0,y.useEffect)(function(){g.setKeyboardLayout(h.notes)},[h]);var b=(e=(0,a.Z)(function(e){var t;return(0,u.__generator)(this,function(a){return t=e.data,n[e.key]=(0,o.Z)((0,r.Z)({},n[e.key]),{value:t.value}),"instrument"===e.key&&m(new V.ZP(t.value)),"caveMode"===e.key&&P.n.setReverb(t.value),"metronomeBpm"===e.key&&(L.A.bpm=t.value),"metronomeBeats"===e.key&&(L.A.beats=t.value),"metronomeVolume"===e.key&&L.A.changeVolume(t.value),c((0,r.Z)({},n)),x(n),[2]})}),function(t){return e.apply(this,arguments)});(0,y.useEffect)(function(){function e(){return(e=(0,a.Z)(function(){return(0,u.__generator)(this,function(e){switch(e.label){case 0:return O.kg.showPill("Loading instrument: ".concat(h.name,"...")),[4,h.load(P.n.getAudioContext())];case 1:return e.sent(),O.kg.hidePill(),P.n.connect(h.endNode),[2]}})})).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){P.n.disconnect(h.endNode)}},[h]),(0,y.useEffect)(function(){v?L.A.start():L.A.stop()},[v]);var k=(0,y.useCallback)(function(e){h.changeVolume(e.value)},[h]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.D,{text:"Zen Keyboard"}),(0,s.jsx)(I,{settings:n,onVolumeChange:k,handleSettingChange:b}),(0,s.jsx)(C,{instrument:h,onNoteClick:function(e){h.play(e.index,n.pitch.value),g.animateNote(e.index)},noteNameType:n.noteNameType.value,pitch:n.pitch.value,scale:n.keyboardSize.value,verticalOffset:n.keyboardYPosition.value}),(0,s.jsx)(l.h,{toggled:v,onClick:function(){return p(!v)},className:"metronome-button",style:{position:"absolute",bottom:"0.8rem",right:"0.8rem"},ariaLabel:"Toggle metronome",children:(0,s.jsx)(D.eHT,{size:22})})]})}M.getLayout=function(e){return(0,s.jsx)(B.Z,{page:"Main",children:e})}}},function(e){e.O(0,[980,208,774,888,179],function(){return e(e.s=9691)}),_N_E=e.O()}]);