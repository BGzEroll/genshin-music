(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[801],{2321:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/midi-setup",function(){return n(9288)}])},6390:function(t,e,n){"use strict";n.d(e,{k:function(){return r}});var s=n(5893),i=n(369);function r(t){var e=t.excludeMenu,n=t.children,r=t.className,c=t.style;return(0,s.jsxs)("div",{className:"default-page "+(void 0===r?"":r),style:c,children:[!(void 0!==e&&e)&&(0,s.jsx)(i.O,{}),(0,s.jsx)("div",{className:"default-content",children:n})]})}},369:function(t,e,n){"use strict";n.d(e,{O:function(){return a}});var s=n(5893),i=n(9583),r=n(7671),c=n(9255),o=n(2809),u=n(1163);function a(t){var e=t.children,n=t.className,a=(0,u.useRouter)();return(0,s.jsx)("div",{className:"menu-wrapper "+(void 0===n?"":n),children:(0,s.jsxs)("div",{className:"menu menu-visible",style:{justifyContent:"flex-end"},children:[c.U.hasNavigated&&(0,s.jsx)(r.s,{style:{marginBottom:"auto"},onClick:function(){a.back()},ariaLabel:"Go back",children:(0,s.jsx)(i.x_l,{className:"icon"})}),void 0===e?void 0:e,(0,s.jsx)(r.s,{ariaLabel:"Go to discord",children:(0,s.jsx)("a",{href:"https://discord.gg/Arsf65YYHq",target:"_blank",rel:"noreferrer",children:(0,s.jsx)(i.j2d,{className:"icon"})})}),(0,s.jsx)(r.s,{onClick:o.I.open,ariaLabel:"Open home menu",children:(0,s.jsx)(i.xng,{className:"icon"})})]})})}},185:function(t,e,n){"use strict";n.d(e,{Z:function(){return d}});var s=n(828),i=n(5893),r=n(2169),c=n(8376),o=n(8949),u=n(7294),a=n(3564),l=n(2114);function d(t){var e,n,d=t.data,m=t.noteText,v=t.handleClick,g=t.noteImage,p=t.clickClass,x=t.noteClass,k=t.noteRef,N=(0,s.Z)((0,u.useState)(f()),2),y=N[0],S=N[1];(0,u.useEffect)(function(){return(0,o.N7)(a.f6.state.data,function(){S(f())})},[]);var j=(e=d.status,n=r.Al.note,"clicked"===e&&(n+=" click-event ".concat(void 0===p?"":p)),n+" ".concat(void 0===x?"":x));return(0,i.jsx)("button",{onPointerDown:function(t){t.preventDefault(),v(d)},className:"button-hitbox-bigger",children:(0,i.jsxs)("div",{ref:k,className:j,style:{borderColor:h(d.status)},children:["Genshin"===r.iC&&(0,i.jsx)(c.Z,{className:"genshin-border",fill:h(d.status)}),g&&(0,i.jsx)(l.Z,{name:g,background:"clicked"===d.status?"var(--accent)":"var(--note-background)"}),(0,i.jsx)("div",{className:r.Al.noteName,style:{color:y},children:void 0===m?"A":m})]})})}function h(t){var e="Genshin"===r.iC?"#eae5ce":"";return"clicked"===t?e="transparent":"wrong"===t?e="#d66969":"right"===t&&(e="#358a55"),e}function f(){var t=a.f6.get("note_background");return"Genshin"!==r.iC?t.isDark()?r.kx.text.light:r.kx.text.dark:t.luminosity()>.65?r.kx.text.note:t.isDark()?r.kx.text.light:r.kx.text.dark}},4995:function(t,e,n){"use strict";n.d(e,{D:function(){return i}});var s=n(7294);function i(t){var e=t.text;return(0,s.useEffect)(function(){document.title=e},[e]),null}},1185:function(t,e,n){"use strict";n.d(e,{z:function(){return u}});var s=n(7568),i=n(1438),r=n(655),c=n(5839),o=n(7557),u=function(){function t(e){(0,i.Z)(this,t),this.instruments=[],this.audioInstruments=[],this.basePitch="C",this.basePitch=e}var e=t.prototype;return e.setBasePitch=function(t){this.basePitch=t},e.destroy=function(){this.audioInstruments.forEach(function(t){o.n.disconnect(t.endNode),t.dispose()})},e.syncInstruments=function(t){return this.instruments=t,this.loadInstruments()},e.loadInstruments=function(){var t=this;return(0,s.Z)(function(){var e,n;return(0,r.__generator)(this,function(i){var u;return e=t.instruments,(n=t.audioInstruments).splice(e.length).forEach(function(t){o.n.disconnect(t.endNode),t.dispose()}),[2,Promise.all(e.map((u=(0,s.Z)(function(t,e){var s,i,u;return(0,r.__generator)(this,function(r){switch(r.label){case 0:if(void 0!==n[e])return[3,2];return s=new c.ZP(t.name),n[e]=s,[4,s.load(o.n.getAudioContext())];case 1:return r.sent(),o.n.connect(s.endNode),s.changeVolume(t.volume),[2,s];case 2:if(n[e].name!==t.name)return[3,3];return n[e].changeVolume(t.volume),[2,n[e]];case 3:return i=n[e],o.n.disconnect(i.endNode),i.dispose(),u=new c.ZP(t.name),n[e]=u,[4,u.load(o.n.getAudioContext())];case 4:return r.sent(),o.n.connect(u.endNode),u.changeVolume(t.volume),[2,u];case 5:return[2]}})}),function(t,e){return u.apply(this,arguments)})))]})})()},e.playNoteOfInstrument=function(t,e,n){var s=this.instruments[t];this.audioInstruments[t].play(e,null!=n?n:s.pitch||this.basePitch)},e.playNotesOfInstrument=function(t,e,n){var s=this;e.forEach(function(e){return s.playNoteOfInstrument(t,e,n)})},t}()},9288:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return b}});var s=n(4111),i=n(7568),r=n(1438),c=n(8668),o=n(828),u=n(6626),a=n(655),l=n(5893),d=n(2169),h=n(185),f=n(7294),m=n(8461);function v(t){var e,n=t.status,s=t.onClick,i=t.type,r=t.selected,c=t.midi;return(0,l.jsx)(m.J,{className:"midi-shortcut ".concat(n),toggled:r,onClick:function(){return s(i)},children:((null===(e=i[0])||void 0===e?void 0:e.toUpperCase())+i.substring(1)).split("_").join(" ")+" (".concat(-1===c?"NA":c,")")})}var g=n(4339),p=n(6138),x=n(7557),k=n(6390),N=n(4995),y=n(1185),S=n(539),j=new(n(5839)).ZP,b=function(t){(0,c.Z)(n,t);var e=(0,u.Z)(n);function n(t){(0,r.Z)(this,n),u=e.call(this,t);var c,u,l=(0,s.Z)(u);u.init=(0,i.Z)(function(){return(0,a.__generator)(this,function(t){switch(t.label){case 0:return[4,l.loadInstrument(d.BX[0])];case 1:return t.sent(),[4,p.mP.enable()];case 2:return t.sent(),p.mP.addInputsListener(l.midiStateChange),p.mP.addListener(l.handleMidi),l.setState({sources:p.mP.inputs,selectedSource:p.mP.currentMIDISource}),[2]}})}),u.midiStateChange=function(t){u.mounted&&(u.state.sources.length>t.length?g.kg.warn("Device disconnected"):t.length>0&&g.kg.warn("Device connected"),u.setState({sources:t}))},u.selectMidi=function(t){u.mounted&&t&&(p.mP.selectSource(t),u.setState({selectedSource:t}),p.mP.saveSettings())},u.deselectNotes=function(){var t=u.state.settings;t.notes.forEach(function(t){t.status=t.midi<0?"wrong":"right"}),u.setState({settings:t})};var h=(0,s.Z)(u);return u.loadInstrument=(c=(0,i.Z)(function(t){var e;return(0,a.__generator)(this,function(n){switch(n.label){case 0:return[4,(e=h.state.audioPlayer).syncInstruments([new S.WH({name:t})])];case 1:if(n.sent().some(function(t){return!t}))return[2,g.kg.error("Error loading instrument")];if(!h.mounted)return[2,e.destroy()];return h.setState({audioPlayer:e}),[2]}})}),function(t){return c.apply(this,arguments)}),u.checkIfUsed=function(t,e){var n=u.state.settings,s=n.shortcuts,i=n.notes;return!!(s.find(function(e){return e.midi===t})&&["all","shortcuts"].includes(e)||i.find(function(e){return e.midi===t})&&["all","notes"].includes(e))},u.handleMidi=function(t){var e=(0,o.Z)(t,3),n=e[0],s=e[1],i=e[2],r=u.state,c=r.selectedNote,a=r.settings,l=r.selectedShortcut;if(p.mP.isDown(n)&&0!==i){if(c){if(u.checkIfUsed(s,"shortcuts"))return g.kg.warn("Key already used");c.midi=s,u.deselectNotes(),u.setState({selectedNote:null}),p.mP.saveSettings()}if(l){var d=a.shortcuts.find(function(t){return t.type===l});if(u.checkIfUsed(s,"all"))return g.kg.warn("Key already used");d&&(d.midi=s,d.status=s<0?"wrong":"right",u.setState({settings:a}),p.mP.saveSettings())}var h=a.shortcuts.find(function(t){return t.midi===s});h&&(h.status="clicked",setTimeout(function(){h.status=s<0?"wrong":"right",u.setState({settings:a})},150),u.setState({settings:a})),a.notes.filter(function(t){return t.midi===s}).forEach(function(t){u.handleClick(t,!0)})}},u.handleClick=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=u.state.settings;e||u.deselectNotes(),t.status="clicked",e?(setTimeout(function(){t.status=t.midi<0?"wrong":"right",u.setState({settings:n})},200),u.setState({settings:n,selectedShortcut:null})):u.setState({settings:n,selectedNote:t,selectedShortcut:null}),u.playSound(t)},u.handleShortcutClick=function(t){if(u.deselectNotes(),u.state.selectedShortcut===t)return u.setState({selectedShortcut:null,selectedNote:null});u.setState({selectedShortcut:t,selectedNote:null})},u.playSound=function(t){void 0!==t&&u.state.audioPlayer.playNoteOfInstrument(0,t.index)},u.state={audioPlayer:new y.z("C"),settings:p.mP.settings,selectedNote:null,selectedShortcut:null,sources:[],selectedSource:null},u.mounted=!0,u}var f=n.prototype;return f.componentDidMount=function(){this.init()},f.componentWillUnmount=function(){this.mounted=!1,this.state.audioPlayer.destroy(),p.mP.clear(),x.n.clear()},f.render=function(){var t=this,e=this.state,n=e.settings,s=e.sources,i=e.selectedShortcut,r=e.selectedSource;return(0,l.jsxs)(k.k,{children:[(0,l.jsx)(N.D,{text:"MIDI Setup"}),(0,l.jsxs)("div",{className:"column midi-setup-column",children:[(0,l.jsxs)("div",{children:["Select MIDI device:",(0,l.jsxs)("select",{className:"midi-select",style:{marginLeft:"0.5rem"},value:r?r.id:"None",onChange:function(e){t.selectMidi(s.find(function(t){return t.id===e.target.value}))},children:[(0,l.jsx)("option",{disabled:!0,value:"None",children:" None"}),s.map(function(t,e){return(0,l.jsxs)("option",{value:t.id,children:[t.name," - ",t.id]},t.id)})]})]}),(0,l.jsx)("div",{style:{margin:"0.5rem 0"},children:"Click on the note to map, then press your MIDI keyboard"})]}),(0,l.jsxs)("div",{className:"midi-setup-content",children:[(0,l.jsx)("div",{className:"Genshin"===d.iC?"keyboard":"keyboard keyboard-5",style:{marginTop:"auto",width:"fit-content"},children:n.notes.map(function(e,n){return(0,l.jsx)(h.Z,{handleClick:function(){return t.handleClick(e)},data:e,noteImage:j.notes[n].noteImage,noteText:e.midi<0?"NA":String(e.midi)},n)})}),(0,l.jsxs)("div",{className:"midi-shortcuts-wrapper",children:[(0,l.jsx)("div",{style:{fontSize:"1.5rem"},children:"Shortcuts"}),(0,l.jsx)("div",{className:"midi-shortcuts",children:n.shortcuts.map(function(e){return(0,l.jsx)(v,{type:e.type,status:e.status,midi:e.midi,selected:i===e.type,onClick:t.handleShortcutClick},e.type)})})]})]})]})},n}(f.Component)}},function(t){t.O(0,[208,774,888,179],function(){return t(t.s=2321)}),_N_E=t.O()}]);